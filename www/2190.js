"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2190],{2190:(be,Z,a)=>{a.r(Z),a.d(Z,{ProfilePageModule:()=>ve});var T=a(9808),J=a(3075),$=a(7460),u=a(931),v=a(655),p=a(7224),C=a(2916),O=a(2654),Q=a(8139),A=a(8929),w=a(341),K=a(2102),V=a(5279),B=a(5283);class N extends A.xQ{constructor(n=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,t){super(),this.scheduler=t,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=n<1?1:n,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(n){if(!this.isStopped){const e=this._events;e.push(n),e.length>this._bufferSize&&e.shift()}super.next(n)}nextTimeWindow(n){this.isStopped||(this._events.push(new H(this._getNow(),n)),this._trimBufferThenGetEvents()),super.next(n)}_subscribe(n){const e=this._infiniteTimeWindow,t=e?this._events:this._trimBufferThenGetEvents(),s=this.scheduler,r=t.length;let l;if(this.closed)throw new V.N;if(this.isStopped||this.hasError?l=O.w.EMPTY:(this.observers.push(n),l=new B.W(this,n)),s&&n.add(n=new K.ht(n,s)),e)for(let c=0;c<r&&!n.closed;c++)n.next(t[c]);else for(let c=0;c<r&&!n.closed;c++)n.next(t[c].value);return this.hasError?n.error(this.thrownError):this.isStopped&&n.complete(),l}_getNow(){return(this.scheduler||w.c).now()}_trimBufferThenGetEvents(){const n=this._getNow(),e=this._bufferSize,t=this._windowTime,s=this._events,r=s.length;let l=0;for(;l<r&&!(n-s[l].time<t);)l++;return r>e&&(l=Math.max(l,r-e)),l>0&&s.splice(0,l),s}}class H{constructor(n,e){this.time=n,this.value=e}}function Y(o){return!!o&&(o instanceof C.y||"function"==typeof o.lift&&"function"==typeof o.subscribe)}var z=a(1086),F=a(3998),X=a(1737),k=a(6053),I=a(1406),q=a(826),_=a(448);class te{constructor(n,e){this.observables=n,this.project=e}call(n,e){return e.subscribe(new ie(n,this.observables,this.project))}}class ie extends q.L{constructor(n,e,t){super(n),this.observables=e,this.project=t,this.toRespond=[];const s=e.length;this.values=new Array(s);for(let r=0;r<s;r++)this.toRespond.push(r);for(let r=0;r<s;r++)this.add((0,_.D)(this,e[r],void 0,r))}notifyNext(n,e,t){this.values[t]=e;const s=this.toRespond;if(s.length>0){const r=s.indexOf(t);-1!==r&&s.splice(r,1)}}notifyComplete(){}_next(n){if(0===this.toRespond.length){const e=[n,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(n){let e;try{e=this.project.apply(this,n)}catch(t){return void this.destination.error(t)}this.destination.next(e)}}var E=a(1177);function P(o){return n=>n.lift(new se(o))}class se{constructor(n){this.notifier=n}call(n,e){const t=new ne(n),s=(0,E.ft)(this.notifier,new E.IY(t));return s&&!t.seenValue?(t.add(s),e.subscribe(t)):t}}class ne extends E.Ds{constructor(n){super(n),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}var oe=a(2986),U=a(4850),re=a(5778);var i=a(2096);function M(){return o=>new C.y(n=>{let e,t;const s=new O.w;return s.add(o.subscribe({complete:()=>{e&&n.next(t),n.complete()},error:r=>{n.error(r)},next:r=>{t=r,e||(e=Q.E.schedule(()=>{n.next(t),e=void 0}),s.add(e))}})),s})}const ce=new i.OlP("@ngrx/component-store Initial State");let ue=(()=>{class o{constructor(e){this.destroySubject$=new N(1),this.destroy$=this.destroySubject$.asObservable(),this.stateSubject$=new N(1),this.isInitialized=!1,this.notInitializedErrorMessage=`${this.constructor.name} has not been initialized yet. Please make sure it is initialized before updating/getting.`,this.state$=this.select(t=>t),e&&this.initState(e)}ngOnDestroy(){this.stateSubject$.complete(),this.destroySubject$.next()}updater(e){return t=>{let s;const l=(Y(t)?t:(0,z.of)(t)).pipe((0,I.b)(c=>this.isInitialized?(0,F.x)([c],w.N).pipe(function ee(...o){return n=>{let e;return"function"==typeof o[o.length-1]&&(e=o.pop()),n.lift(new te(o,e))}}(this.stateSubject$)):(0,X._)(()=>new Error(this.notInitializedErrorMessage))),P(this.destroy$)).subscribe({next:([c,f])=>{this.stateSubject$.next(e(f,c))},error:c=>{s=c,this.stateSubject$.error(c)}});if(s)throw s;return l}}initState(e){(0,F.x)([e],w.N).subscribe(t=>{this.isInitialized=!0,this.stateSubject$.next(t)})}setState(e){"function"!=typeof e?this.initState(e):this.updater(e)()}patchState(e){const t="function"==typeof e?e(this.get()):e;this.updater((s,r)=>Object.assign(Object.assign({},s),r))(t)}get(e){if(!this.isInitialized)throw new Error(this.notInitializedErrorMessage);let t;return this.stateSubject$.pipe((0,oe.q)(1)).subscribe(s=>{t=e?e(s):s}),t}select(...e){const{observables:t,projector:s,config:r}=function fe(o){const n=Array.from(o);let t,e={debounce:!1};const s=n.pop();return"function"!=typeof s?(e=Object.assign(Object.assign({},e),s),t=n.pop()):t=s,{observables:n,projector:t,config:e}}(e);let l;return l=0===t.length?this.stateSubject$.pipe(r.debounce?M():c=>c,(0,U.U)(c=>s(c))):(0,k.aj)(t).pipe(r.debounce?M():c=>c,(0,U.U)(c=>s(...c))),l.pipe((0,re.x)(),function le(o,n,e){let t;return t=o&&"object"==typeof o?o:{bufferSize:o,windowTime:n,refCount:!1,scheduler:e},s=>s.lift(function ae({bufferSize:o=Number.POSITIVE_INFINITY,windowTime:n=Number.POSITIVE_INFINITY,refCount:e,scheduler:t}){let s,l,r=0,c=!1,f=!1;return function(Pe){let x;r++,!s||c?(c=!1,s=new N(o,n,t),x=s.subscribe(this),l=Pe.subscribe({next(j){s.next(j)},error(j){c=!0,s.error(j)},complete(){f=!0,l=void 0,s.complete()}}),f&&(l=void 0)):x=s.subscribe(this),this.add(()=>{r--,x.unsubscribe(),x=void 0,l&&!f&&e&&0===r&&(l.unsubscribe(),l=void 0,s=void 0)})}}(t))}({refCount:!0,bufferSize:1}),P(this.destroy$))}effect(e){const t=new A.xQ;return e(t).pipe(P(this.destroy$)).subscribe(),s=>(Y(s)?s:(0,z.of)(s)).pipe(P(this.destroy$)).subscribe(l=>{t.next(l)})}}return o.\u0275fac=function(e){return new(e||o)(i.LFG(ce,8))},o.\u0275prov=i.Yz7({token:o,factory:o.\u0275fac}),o})();var h=a(8896),b=a(7545),d=a(2868),m=a(7221),g=a(3725),S=a(7323),L=a(649),R=a(567),y=a(3527),G=a(7556);let D=(()=>{class o{constructor(e,t){this.firestore=e,this.authService=t}getUserProfileReference(){return this.authService.getUser().pipe((0,U.U)(e=>(this.currentUser=e,(0,g.JU)(this.firestore,`users/${e.uid}`))),(0,m.K)(()=>h.E))}getUserProfile(){return this.getUserProfileReference().pipe((0,b.w)(e=>(0,g._1)(e)),(0,m.K)(()=>h.E))}updateName(e){return this.getUserProfileReference().pipe((0,d.b)({next:t=>(0,g.pl)(t,{fullName:e},{merge:!0}),error:t=>console.error(t)}),(0,m.K)(()=>h.E))}updateEmail(e,t){return(0,R.D)([this.getUserProfile().pipe((0,p.P)()),this.authService.getUser().pipe((0,p.P)()),this.getUserProfileReference().pipe((0,p.P)())]).pipe((0,I.b)(([s,r,l])=>{const c=L.w9.credential(s.email,t);return(0,y.D)((0,S.aF)(r,c)).pipe((0,d.b)({next:()=>(0,y.D)((0,S.s)(r,e).then(()=>(0,g.pl)(l,{email:e},{merge:!0}))),error:f=>console.error(f)}))}))}updatePassword(e,t){return(0,R.D)([this.getUserProfile().pipe((0,p.P)()),this.authService.getUser().pipe((0,p.P)())]).pipe((0,I.b)(([s,r])=>{const l=L.w9.credential(s.email,t);return(0,y.D)((0,S.aF)(r,l)).pipe((0,d.b)({next:()=>(0,y.D)((0,S.gQ)(r,e)),error:c=>console.error(c)}))}))}}return o.\u0275fac=function(e){return new(e||o)(i.LFG(g.gg),i.LFG(G.e))},o.\u0275prov=i.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),W=(()=>{class o extends ue{constructor(e){super({email:"",fullName:""}),this.profileService=e,this.userProfile$=this.select(t=>t),this.updateEmail=this.updater((t,s)=>Object.assign(Object.assign({},t),{email:s})),this.updateFullName=this.updater((t,s)=>Object.assign(Object.assign({},t),{fullName:s})),this.updateUserName=this.effect(t=>t.pipe((0,b.w)(s=>this.profileService.updateName(s).pipe((0,d.b)({next:()=>this.updateFullName(s),error:r=>console.log(r)}),(0,m.K)(()=>h.E))))),this.updateUserEmail=this.effect(t=>t.pipe((0,b.w)(({email:s,password:r})=>this.profileService.updateEmail(s,r).pipe((0,d.b)({next:()=>this.updateEmail(s),error:l=>console.log(l)}),(0,m.K)(()=>h.E))))),this.updateUserPassword=this.effect(t=>t.pipe((0,b.w)(({newPassword:s,oldPassword:r})=>this.profileService.updatePassword(s,r).pipe((0,d.b)({next:()=>console.log("Updated Passwords"),error:l=>console.log(l)}),(0,m.K)(()=>h.E)))))}}return o.\u0275fac=function(e){return new(e||o)(i.LFG(D))},o.\u0275prov=i.Yz7({token:o,factory:o.\u0275fac}),o})();function pe(o,n){if(1&o&&(i.TgZ(0,"ion-col",9),i._uU(1),i.ALo(2,"async"),i.qZA()),2&o){const e=i.oxw();let t;i.xp6(1),i.hij(" ",null==(t=i.lcZ(2,1,e.userProfile$))?null:t.fullName," ")}}function he(o,n){1&o&&(i.TgZ(0,"ion-col",10)(1,"span"),i._uU(2," Tap here to edit. "),i.qZA()())}function de(o,n){if(1&o&&(i.TgZ(0,"ion-col",9),i._uU(1),i.ALo(2,"async"),i.qZA()),2&o){const e=i.oxw();let t;i.xp6(1),i.hij(" ",null==(t=i.lcZ(2,1,e.userProfile$))?null:t.email," ")}}function me(o,n){1&o&&(i.TgZ(0,"ion-col",10)(1,"span"),i._uU(2," Tap here to edit. "),i.qZA()())}const ge=[{path:"",component:(()=>{class o{constructor(e,t,s,r,l){this.authService=e,this.router=t,this.profileService=s,this.alertCtrl=r,this.profileStore=l,this.userProfile$=this.profileStore.userProfile$}ngOnInit(){this.userProfileSubscription=this.profileService.getUserProfile().subscribe(e=>this.profileStore.setState(e))}ngOnDestroy(){var e;null===(e=this.userProfileSubscription)||void 0===e||e.unsubscribe()}logOut(){return(0,v.mG)(this,void 0,void 0,function*(){yield this.authService.logout(),this.router.navigateByUrl("login")})}updateName(){this.userProfileSubscription=this.userProfile$.pipe((0,p.P)()).subscribe(e=>(0,v.mG)(this,void 0,void 0,function*(){return yield(yield this.alertCtrl.create({subHeader:"Your name",inputs:[{type:"text",name:"fullName",placeholder:"Your full name",value:e.fullName}],buttons:[{text:"Cancel"},{text:"Save",handler:s=>{this.profileStore.updateUserName(s.fullName)}}]})).present()}))}updateEmail(){return(0,v.mG)(this,void 0,void 0,function*(){return yield(yield this.alertCtrl.create({inputs:[{type:"text",name:"newEmail",placeholder:"Your new email"},{name:"password",placeholder:"Your password",type:"password"}],buttons:[{text:"Cancel"},{text:"Save",handler:t=>{this.profileStore.updateUserEmail({email:t.newEmail,password:t.password})}}]})).present()})}updatePassword(){return(0,v.mG)(this,void 0,void 0,function*(){return yield(yield this.alertCtrl.create({inputs:[{name:"newPassword",placeholder:"New password",type:"password"},{name:"oldPassword",placeholder:"Old password",type:"password"}],buttons:[{text:"Cancel"},{text:"Save",handler:t=>{this.profileStore.updateUserPassword({newPassword:t.newPassword,oldPassword:t.oldPassword})}}]})).present()})}}return o.\u0275fac=function(e){return new(e||o)(i.Y36(G.e),i.Y36($.F0),i.Y36(D),i.Y36(u.Br),i.Y36(W))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-profile"]],features:[i._Bn([W])],decls:42,vars:12,consts:[["slot","start"],["defaultHref","/home"],["slot","end"],[3,"click"],["slot","icon-only","name","log-out"],["size","5",1,"text-left"],["class","text-center","size","7",4,"ngIf"],["size","7","class","placeholder-profile text-center",4,"ngIf"],["size","7",1,"placeholder-profile"],["size","7",1,"text-center"],["size","7",1,"placeholder-profile","text-center"]],template:function(e,t){if(1&e&&(i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),i._UZ(3,"ion-back-button",1),i.qZA(),i.TgZ(4,"ion-title"),i._uU(5,"Profile Page"),i.qZA(),i.TgZ(6,"ion-buttons",2)(7,"ion-button",3),i.NdJ("click",function(){return t.logOut()}),i._UZ(8,"ion-icon",4),i.qZA()()()(),i.TgZ(9,"ion-content")(10,"ion-list")(11,"ion-list-header"),i._uU(12," Personal Information "),i.qZA()(),i.TgZ(13,"ion-item",3),i.NdJ("click",function(){return t.updateName()}),i.TgZ(14,"ion-label")(15,"ion-grid")(16,"ion-row")(17,"ion-col",5),i._uU(18," Name "),i.qZA(),i.YNc(19,pe,3,3,"ion-col",6),i.ALo(20,"async"),i.YNc(21,he,3,0,"ion-col",7),i.ALo(22,"async"),i.qZA()()()(),i.TgZ(23,"ion-item",3),i.NdJ("click",function(){return t.updateEmail()}),i.TgZ(24,"ion-label")(25,"ion-grid")(26,"ion-row")(27,"ion-col",5),i._uU(28," Email "),i.qZA(),i.YNc(29,de,3,3,"ion-col",6),i.ALo(30,"async"),i.YNc(31,me,3,0,"ion-col",7),i.ALo(32,"async"),i.qZA()()()(),i.TgZ(33,"ion-item",3),i.NdJ("click",function(){return t.updatePassword()}),i.TgZ(34,"ion-label")(35,"ion-grid")(36,"ion-row")(37,"ion-col",5),i._uU(38," Password "),i.qZA(),i.TgZ(39,"ion-col",8)(40,"span"),i._uU(41," Tap here to edit. "),i.qZA()()()()()()()),2&e){let s,r,l,c;i.xp6(19),i.Q6J("ngIf",null==(s=i.lcZ(20,4,t.userProfile$))?null:s.fullName),i.xp6(2),i.Q6J("ngIf",!(null!=(r=i.lcZ(22,6,t.userProfile$))&&r.fullName)),i.xp6(8),i.Q6J("ngIf",null==(l=i.lcZ(30,8,t.userProfile$))?null:l.email),i.xp6(2),i.Q6J("ngIf",!(null!=(c=i.lcZ(32,10,t.userProfile$))&&c.email))}},directives:[u.Gu,u.sr,u.Sm,u.oU,u.cs,u.wd,u.YG,u.gu,u.W2,u.q_,u.yh,u.Ie,u.Q$,u.jY,u.Nd,u.wI,T.O5],pipes:[T.Ov],styles:["ion-list-header[_ngcontent-%COMP%]{background-color:#ececec}.text-center[_ngcontent-%COMP%]{text-align:center}.text-left[_ngcontent-%COMP%]{text-align:left}.placeholder-profile[_ngcontent-%COMP%]{color:#ccc}"]}),o})()}];let ve=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[[T.ez,J.u5,u.Pc,$.Bz.forChild(ge)]]}),o})()}}]);