"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4622],{4622:(ce,R,p)=>{p.r(R),p.d(R,{FoodPageModule:()=>ae});var T=p(9808),w=p(3075),g=p(9928),I=p(7460),h=p(655),m=p(3725),F=p(4850),O=p(7221),U=p(8896),S=p(2916),N=p(3753),_={error:"cordova_not_available"},b={error:"plugin_not_installed"};function A(e){if("undefined"!=typeof window&&window.angular){var n=window.document,t=window.angular.element(n.querySelector("[ng-app]")||n.body).injector();if(t)return t.get("$q")(function(a,c){e(a,c)});console.warn("Angular 1 was detected but $q couldn't be retrieved. This is usually when the app is not bootstrapped on the html or body tag. Falling back to native promises which won't trigger an automatic digest when promises resolve.")}return function(){if(Promise)return new Promise(function(a,c){e(a,c)});console.error("No Promise support or polyfill found. To enable Ionic Native support, please add the es6-promise polyfill before this script, or run with a library like Angular or on a recent browser.")}()}function Z(e,r,n,t){void 0===t&&(t={});var o,a,c=A(function(u,l){o=t.destruct?P(e,r,n,t,function(){for(var d=[],s=0;s<arguments.length;s++)d[s]=arguments[s];return u(d)},function(){for(var d=[],s=0;s<arguments.length;s++)d[s]=arguments[s];return l(d)}):P(e,r,n,t,u,l),a=l});return o&&o.error&&(c.catch(function(){}),"function"==typeof a&&a(o.error)),c}function W(e,r,n,t){return void 0===t&&(t={}),A(function(o,a){var c=P(e,r,n,t);c?c.error?a(c.error):c.then&&c.then(o).catch(a):a({error:"unexpected_error"})})}function G(e,r,n,t){return void 0===t&&(t={}),new S.y(function(o){var a;return a=t.destruct?P(e,r,n,t,function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];return o.next(c)},function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];return o.error(c)}):P(e,r,n,t,o.next.bind(o),o.error.bind(o)),a&&a.error&&(o.error(a.error),o.complete()),function(){try{if(t.clearFunction)return t.clearWithArgs?P(e,t.clearFunction,n,t,o.next.bind(o),o.error.bind(o)):P(e,t.clearFunction,[])}catch(c){console.warn("Unable to clear the previous observable watch for",e.constructor.getPluginName(),r),console.warn(c)}}})}function J(e,r){return r="undefined"!=typeof window&&r?D(window,r):r||("undefined"!=typeof window?window:{}),(0,N.R)(r,e)}function E(e,r,n){var t,o,a;return"string"==typeof e?t=e:(t=e.constructor.getPluginRef(),n=e.constructor.getPluginName(),a=e.constructor.getPluginInstallName()),!(!(o=M(t))||r&&void 0===o[r])||("undefined"!=typeof window&&window.cordova?(function B(e,r,n){console.warn(n?"Native: tried calling "+e+"."+n+", but the "+e+" plugin is not installed.":"Native: tried accessing the "+e+" plugin but it's not installed."),r&&console.warn("Install the "+e+" plugin: 'ionic cordova plugin add "+r+"'")}(n,a,r),b):(function H(e,r){"undefined"==typeof process&&console.warn(r?"Native: tried calling "+e+"."+r+", but Cordova is not available. Make sure to include cordova.js or run in a device/simulator":"Native: tried accessing the "+e+" plugin but Cordova is not available. Make sure to include cordova.js or run in a device/simulator")}(n,r),_))}function P(e,r,n,t,o,a){void 0===t&&(t={}),n=function C(e,r,n,t){if(void 0===r&&(r={}),r.sync)return e;if("reverse"===r.callbackOrder)e.unshift(t),e.unshift(n);else if("node"===r.callbackStyle)e.push(function(u,l){u?t(u):n(l)});else if("object"===r.callbackStyle&&r.successName&&r.errorName){var o={};o[r.successName]=n,o[r.errorName]=t,e.push(o)}else if(void 0!==r.successIndex||void 0!==r.errorIndex){var a=function(){r.successIndex>e.length?e[r.successIndex]=n:e.splice(r.successIndex,0,n)},c=function(){r.errorIndex>e.length?e[r.errorIndex]=t:e.splice(r.errorIndex,0,t)};r.successIndex>r.errorIndex?(c(),a()):(a(),c())}else e.push(n),e.push(t);return e}(n,t,o,a);var c=E(e,r);if(!0===c){var u=M(e.constructor.getPluginRef());return u[r].apply(u,n)}return c}function M(e){return"undefined"!=typeof window?D(window,e):null}function D(e,r){for(var n=r.split("."),t=e,o=0;o<n.length;o++){if(!t)return null;t=t[n[o]]}return t}var z=function(){function e(){}return e.installed=function(){return!0===E(this.pluginRef)},e.getPlugin=function(){return"undefined"!=typeof window?function V(e,r){for(var n=r.split("."),t=e,o=0;o<n.length;o++){if(!t)return null;t=t[n[o]]}return t}(window,this.pluginRef):null},e.getPluginName=function(){return this.pluginName},e.getPluginRef=function(){return this.pluginRef},e.getPluginInstallName=function(){return this.plugin},e.getSupportedPlatforms=function(){return this.platforms},e.pluginName="",e.pluginRef="",e.plugin="",e.repo="",e.platforms=[],e.install="",e}();function x(e,r,n,t){return function(e,r,n){return void 0===n&&(n={}),function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return n.sync?P(e,r,t,n):n.observable?G(e,r,t,n):n.eventObservable&&n.event?J(n.event,n.element):n.otherPromise?W(e,r,t,n):Z(e,r,t,n)}}(e,r,n).apply(this,t)}!function L(){if("undefined"==typeof process){var e="undefined"!=typeof window?window:{},n=Date.now(),t=!1;e.document.addEventListener("deviceready",function(){console.log("Ionic Native: deviceready event fired after "+(Date.now()-n)+" ms"),t=!0}),setTimeout(function(){!t&&e.cordova&&console.warn("Ionic Native: deviceready did not fire within 5000ms. This can happen when plugins are in an inconsistent state. Try removing plugins from plugins/ and reinstalling them.")},5e3)}}();var i=p(2096),$=function(e){function r(){var n=null!==e&&e.apply(this,arguments)||this;return n.DestinationType={DATA_URL:0,FILE_URI:1,NATIVE_URI:2},n.EncodingType={JPEG:0,PNG:1},n.MediaType={PICTURE:0,VIDEO:1,ALLMEDIA:2},n.PictureSourceType={PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2},n.PopoverArrowDirection={ARROW_UP:1,ARROW_DOWN:2,ARROW_LEFT:4,ARROW_RIGHT:8,ARROW_ANY:15},n.Direction={BACK:0,FRONT:1},n}return(0,h.ZT)(r,e),r.prototype.getPicture=function(n){return x(this,"getPicture",{callbackOrder:"reverse"},arguments)},r.prototype.cleanup=function(){return x(this,"cleanup",{platforms:["iOS"]},arguments)},r.pluginName="Camera",r.plugin="cordova-plugin-camera",r.pluginRef="navigator.camera",r.repo="https://github.com/apache/cordova-plugin-camera",r.platforms=["Android","Browser","iOS","Windows"],r.\u0275fac=function(){var n;return function(o){return(n||(n=i.n5z(r)))(o||r)}}(),r.\u0275prov=i.Yz7({token:r,factory:function(n){return r.\u0275fac(n)}}),r}(z),Q=p(7556),K=p(8037),X=p(4457);function j(e,r){if(1&e){const n=i.EpF();i.TgZ(0,"ion-col",9)(1,"ion-card",10)(2,"ion-card-header")(3,"ion-card-title")(4,"strong"),i._uU(5),i.qZA()()(),i.TgZ(6,"ion-card-content",11),i._UZ(7,"ion-img",12),i.qZA(),i.TgZ(8,"ion-button",13),i.NdJ("click",function(){const a=i.CHM(n).$implicit;return i.oxw(2).addIngredient(a.id,a.name,a.image)}),i._UZ(9,"ion-icon",14),i.qZA()()()}if(2&e){const n=r.$implicit;i.xp6(5),i.Oqu(n.name.toUpperCase()),i.xp6(2),i.Q6J("src","https://spoonacular.com/cdn/ingredients_100x100/"+n.image)}}function ee(e,r){if(1&e&&(i.TgZ(0,"ion-grid")(1,"ion-row"),i.YNc(2,j,10,2,"ion-col",8),i.qZA()()),2&e){const n=i.oxw();i.xp6(2),i.Q6J("ngForOf",n.searchResults)}}function ne(e,r){if(1&e){const n=i.EpF();i.TgZ(0,"ion-col",9)(1,"ion-card",10)(2,"ion-card-header")(3,"ion-card-title")(4,"strong"),i._uU(5),i.qZA()()(),i.TgZ(6,"ion-card-content",11),i._UZ(7,"ion-img",12),i.qZA(),i.TgZ(8,"ion-button",15),i.NdJ("click",function(){const a=i.CHM(n).$implicit;return i.oxw(2).deleteIngredient(a.id)}),i._UZ(9,"ion-icon",16),i.qZA()()()}if(2&e){const n=r.$implicit;i.xp6(5),i.Oqu(n.name.toUpperCase()),i.xp6(2),i.Q6J("src",n.image)}}function re(e,r){if(1&e&&(i.TgZ(0,"ion-grid")(1,"ion-row"),i.YNc(2,ne,10,2,"ion-col",8),i.qZA()()),2&e){const n=i.oxw();i.xp6(2),i.Q6J("ngForOf",n.ingredients)}}function te(e,r){1&e&&(i.TgZ(0,"div",17)(1,"p",18),i._uU(2,"Your fridge is empty"),i.qZA()())}const ie=[{path:"",component:(()=>{class e{constructor(n,t,o,a,c,u,l,d){this.firestore=n,this.authService=t,this.profileService=o,this.spoonacularService=a,this.loadingController=c,this.alertController=u,this.camera=l,this.toastController=d}ngOnInit(){return(0,h.mG)(this,void 0,void 0,function*(){yield this.presentLoading(),this.ingredients=[],yield this.loadIngredients(),yield this.loadingController.dismiss()})}ionViewDidEnter(){this.loadIngredients()}presentLoading(){return(0,h.mG)(this,void 0,void 0,function*(){yield(yield this.loadingController.create({message:"Loading ingredients..."})).present()})}loadIngredients(){return(0,h.mG)(this,void 0,void 0,function*(){this.authService.getUser().pipe((0,F.U)(n=>(this.currentUser=n,(0,m.JU)(this.firestore,`users/${n.uid}/fridges/fridge`))),(0,O.K)(()=>U.E)).subscribe(n=>(0,h.mG)(this,void 0,void 0,function*(){try{const t=(0,m.hJ)(n,"ingredients"),o=yield(0,m.PL)(t);this.ingredients=o.docs.map(a=>{const c=a.data();return{id:a.id,name:c.name,image:c.image}})}catch(t){console.log("Error loading ingredients:",t)}}),n=>{console.log("Error getting user:",n)})})}selectIngredients(){return(0,h.mG)(this,void 0,void 0,function*(){yield this.presentLoading(),this.spoonacularService.searchIngredients(this.searchQuery).subscribe(n=>(0,h.mG)(this,void 0,void 0,function*(){this.searchResults=n.results,this.searchResults.forEach((t,o)=>{this.ingredients.find(c=>c.name===t.name)&&this.searchResults.splice(o,1)}),yield this.loadingController.dismiss()}),n=>(0,h.mG)(this,void 0,void 0,function*(){console.log("Error searching ingredients:",n),yield this.loadingController.dismiss()}))})}addIngredient(n,t,o){return(0,h.mG)(this,void 0,void 0,function*(){const a={id:n,name:t,image:"https://spoonacular.com/cdn/ingredients_100x100/"+o},c=(0,m.hJ)(this.firestore,`users/${this.currentUser.uid}/fridges/fridge/ingredients`);try{yield(0,m.ET)(c,a),-1!==this.searchResults.findIndex(d=>d.id===n)&&(this.searchResults=this.searchResults.filter(d=>d.id!==n)),this.loadIngredients(),(yield this.toastController.create({message:"The ingredient has been added successfully",duration:2e3,position:"top",animated:!0,color:"success"})).present()}catch(u){console.log("Error adding ingredient:",u)}})}deleteIngredient(n){return(0,h.mG)(this,void 0,void 0,function*(){const t=(0,m.JU)(this.firestore,`users/${this.currentUser.uid}/fridges/fridge/ingredients/${n}`);try{yield(0,m.oe)(t),(yield this.toastController.create({message:"The ingredient has been removed successfully",duration:2e3,position:"top",animated:!0,color:"danger"})).present()}catch(o){console.log("Error adding ingredient:",o)}this.loadIngredients()})}addIngredientsWithPicture(){return(0,h.mG)(this,void 0,void 0,function*(){try{this.camera.getPicture({quality:80,destinationType:this.camera.DestinationType.DATA_URL,sourceType:this.camera.PictureSourceType.CAMERA,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0}).then(t=>{fetch("https://vision.googleapis.com/v1/images:annotate?key=AIzaSyCzM3dSOLLxBqEOrthKOHYR6iqXNYrfSAA",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requests:[{image:{content:t},features:[{type:"LABEL_DETECTION",maxResults:10}]}]})}).then(u=>{if(!u.ok)throw new Error("Error calling Google Cloud Vision API");return u.json()}).then(u=>{u.responses[0].labelAnnotations.forEach(d=>{console.log(u),console.log(d.description)})}).catch(u=>{console.error("Error:",u)})}).catch(t=>{console.error("Camera error:",t)})}catch(n){console.error("Error:",n)}})}}return e.\u0275fac=function(n){return new(n||e)(i.Y36(m.gg),i.Y36(Q.e),i.Y36(K.H),i.Y36(X.q),i.Y36(g.HT),i.Y36(g.Br),i.Y36($),i.Y36(g.yF))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-food"]],decls:17,vars:5,consts:[[3,"placeholder","ngModel","ngModelChange","ionChange"],[4,"ngIf"],[1,"favorite-header"],[1,"favorite-header-title"],[1,"icon-container","ion-align-items-center"],["color","success",3,"click"],[4,"ngIf","ngIfElse"],["emptyFridge",""],["size","6",4,"ngFor","ngForOf"],["size","6"],[1,"ingredient-card"],[1,"ingredient-content"],["alt","No picture found for this ingredient",1,"ingredient-image",3,"src"],["color","primary",1,"add-button",3,"click"],["name","add-circle"],["color","danger",1,"add-button",3,"click"],["name","trash"],[1,"empty-fridge",2,"margin-bottom","150px"],[1,"text"]],template:function(n,t){if(1&n&&(i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),i._uU(3,"SmartCook"),i.qZA()()(),i.TgZ(4,"ion-content")(5,"ion-searchbar",0),i.NdJ("ngModelChange",function(a){return t.searchQuery=a})("ionChange",function(){return t.selectIngredients()}),i.qZA(),i.YNc(6,ee,3,1,"ion-grid",1),i.TgZ(7,"div",2)(8,"ion-list")(9,"ion-list-header",3),i._uU(10,"My fridge ingredients"),i.qZA()()(),i.TgZ(11,"div",4)(12,"ion-button",5),i.NdJ("click",function(){return t.addIngredientsWithPicture()}),i._uU(13," Add ingredients with a picture "),i.qZA()(),i.YNc(14,re,3,1,"ion-grid",6),i.YNc(15,te,3,0,"ng-template",null,7,i.W1O),i.qZA()),2&n){const o=i.MAs(16);i.xp6(5),i.Q6J("placeholder","Search for ingredients ...")("ngModel",t.searchQuery),i.xp6(1),i.Q6J("ngIf",t.searchResults&&t.searchResults.length>0),i.xp6(8),i.Q6J("ngIf",t.ingredients&&t.ingredients.length>0)("ngIfElse",o)}},directives:[g.Gu,g.sr,g.wd,g.W2,g.VI,g.j9,w.JJ,w.On,T.O5,g.jY,g.Nd,T.sg,g.wI,g.PM,g.Zi,g.Dq,g.FN,g.Xz,g.YG,g.gu,g.q_,g.yh],styles:[".empty-fridge[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;text-align:center}.empty-fridge[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:green;font-size:4rem;margin-bottom:1rem}.empty-fridge[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:1.5rem}.ingredient-card[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;align-items:center;justify-content:space-between}.ingredient-image[_ngcontent-%COMP%]{width:100%;height:auto;object-fit:contain}.ingredient-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;margin-bottom:10px}.add-button[_ngcontent-%COMP%]{width:100%;margin-top:2px}"]}),e})()}];let oe=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[I.Bz.forChild(ie)],I.Bz]}),e})(),ae=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[T.ez,w.u5,g.Pc,oe]]}),e})()}}]);