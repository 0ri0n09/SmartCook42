"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9288],{9288:(de,T,a)=>{a.r(T),a.d(T,{ProfilePageModule:()=>he});var m=a(9808),z=a(3075),N=a(7460),u=a(931),h=a(655),M=a(7224),I=a(2916),E=a(2654),L=a(8139),j=a(8929),g=a(341),F=a(2102),R=a(5279),W=a(5283);class v extends j.xQ{constructor(n=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,t){super(),this.scheduler=t,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=n<1?1:n,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(n){if(!this.isStopped){const e=this._events;e.push(n),e.length>this._bufferSize&&e.shift()}super.next(n)}nextTimeWindow(n){this.isStopped||(this._events.push(new G(this._getNow(),n)),this._trimBufferThenGetEvents()),super.next(n)}_subscribe(n){const e=this._infiniteTimeWindow,t=e?this._events:this._trimBufferThenGetEvents(),s=this.scheduler,r=t.length;let l;if(this.closed)throw new R.N;if(this.isStopped||this.hasError?l=E.w.EMPTY:(this.observers.push(n),l=new W.W(this,n)),s&&n.add(n=new F.ht(n,s)),e)for(let c=0;c<r&&!n.closed;c++)n.next(t[c]);else for(let c=0;c<r&&!n.closed;c++)n.next(t[c].value);return this.hasError?n.error(this.thrownError):this.isStopped&&n.complete(),l}_getNow(){return(this.scheduler||g.c).now()}_trimBufferThenGetEvents(){const n=this._getNow(),e=this._bufferSize,t=this._windowTime,s=this._events,r=s.length;let l=0;for(;l<r&&!(n-s[l].time<t);)l++;return r>e&&(l=Math.max(l,r-e)),l>0&&s.splice(0,l),s}}class G{constructor(n,e){this.time=n,this.value=e}}function $(o){return!!o&&(o instanceof I.y||"function"==typeof o.lift&&"function"==typeof o.subscribe)}var Z=a(1086),C=a(3998),J=a(1737),Q=a(6053),D=a(1406),V=a(826),B=a(448);class K{constructor(n,e){this.observables=n,this.project=e}call(n,e){return e.subscribe(new X(n,this.observables,this.project))}}class X extends V.L{constructor(n,e,t){super(n),this.observables=e,this.project=t,this.toRespond=[];const s=e.length;this.values=new Array(s);for(let r=0;r<s;r++)this.toRespond.push(r);for(let r=0;r<s;r++)this.add((0,B.D)(this,e[r],void 0,r))}notifyNext(n,e,t){this.values[t]=e;const s=this.toRespond;if(s.length>0){const r=s.indexOf(t);-1!==r&&s.splice(r,1)}}notifyComplete(){}_next(n){if(0===this.toRespond.length){const e=[n,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(n){let e;try{e=this.project.apply(this,n)}catch(t){return void this.destination.error(t)}this.destination.next(e)}}var b=a(1177);function p(o){return n=>n.lift(new k(o))}class k{constructor(n){this.notifier=n}call(n,e){const t=new q(n),s=(0,b.ft)(this.notifier,new b.IY(t));return s&&!t.seenValue?(t.add(s),e.subscribe(t)):t}}class q extends b.Ds{constructor(n){super(n),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}var _=a(2986),O=a(4850),ee=a(5778);var i=a(2096);function A(){return o=>new I.y(n=>{let e,t;const s=new E.w;return s.add(o.subscribe({complete:()=>{e&&n.next(t),n.complete()},error:r=>{n.error(r)},next:r=>{t=r,e||(e=L.E.schedule(()=>{n.next(t),e=void 0}),s.add(e))}})),s})}const se=new i.OlP("@ngrx/component-store Initial State");let ne=(()=>{class o{constructor(e){this.destroySubject$=new v(1),this.destroy$=this.destroySubject$.asObservable(),this.stateSubject$=new v(1),this.isInitialized=!1,this.notInitializedErrorMessage=`${this.constructor.name} has not been initialized yet. Please make sure it is initialized before updating/getting.`,this.state$=this.select(t=>t),e&&this.initState(e)}ngOnDestroy(){this.stateSubject$.complete(),this.destroySubject$.next()}updater(e){return t=>{let s;const l=($(t)?t:(0,Z.of)(t)).pipe((0,D.b)(c=>this.isInitialized?(0,C.x)([c],g.N).pipe(function H(...o){return n=>{let e;return"function"==typeof o[o.length-1]&&(e=o.pop()),n.lift(new K(o,e))}}(this.stateSubject$)):(0,J._)(()=>new Error(this.notInitializedErrorMessage))),p(this.destroy$)).subscribe({next:([c,f])=>{this.stateSubject$.next(e(f,c))},error:c=>{s=c,this.stateSubject$.error(c)}});if(s)throw s;return l}}initState(e){(0,C.x)([e],g.N).subscribe(t=>{this.isInitialized=!0,this.stateSubject$.next(t)})}setState(e){"function"!=typeof e?this.initState(e):this.updater(e)()}patchState(e){const t="function"==typeof e?e(this.get()):e;this.updater((s,r)=>Object.assign(Object.assign({},s),r))(t)}get(e){if(!this.isInitialized)throw new Error(this.notInitializedErrorMessage);let t;return this.stateSubject$.pipe((0,_.q)(1)).subscribe(s=>{t=e?e(s):s}),t}select(...e){const{observables:t,projector:s,config:r}=function oe(o){const n=Array.from(o);let t,e={debounce:!1};const s=n.pop();return"function"!=typeof s?(e=Object.assign(Object.assign({},e),s),t=n.pop()):t=s,{observables:n,projector:t,config:e}}(e);let l;return l=0===t.length?this.stateSubject$.pipe(r.debounce?A():c=>c,(0,O.U)(c=>s(c))):(0,Q.aj)(t).pipe(r.debounce?A():c=>c,(0,O.U)(c=>s(...c))),l.pipe((0,ee.x)(),function te(o,n,e){let t;return t=o&&"object"==typeof o?o:{bufferSize:o,windowTime:n,refCount:!1,scheduler:e},s=>s.lift(function ie({bufferSize:o=Number.POSITIVE_INFINITY,windowTime:n=Number.POSITIVE_INFINITY,refCount:e,scheduler:t}){let s,l,r=0,c=!1,f=!1;return function(pe){let d;r++,!s||c?(c=!1,s=new v(o,n,t),d=s.subscribe(this),l=pe.subscribe({next(w){s.next(w)},error(w){c=!0,s.error(w)},complete(){f=!0,l=void 0,s.complete()}}),f&&(l=void 0)):d=s.subscribe(this),this.add(()=>{r--,d.unsubscribe(),d=void 0,l&&!f&&e&&0===r&&(l.unsubscribe(),l=void 0,s=void 0)})}}(t))}({refCount:!0,bufferSize:1}),p(this.destroy$))}effect(e){const t=new j.xQ;return e(t).pipe(p(this.destroy$)).subscribe(),s=>($(s)?s:(0,Z.of)(s)).pipe(p(this.destroy$)).subscribe(l=>{t.next(l)})}}return o.\u0275fac=function(e){return new(e||o)(i.LFG(se,8))},o.\u0275prov=i.Yz7({token:o,factory:o.\u0275fac}),o})();var P=a(8896),S=a(7545),y=a(2868),x=a(7221),U=a(8037);let Y=(()=>{class o extends ne{constructor(e){super({email:"",fullName:""}),this.profileService=e,this.userProfile$=this.select(t=>t),this.updateEmail=this.updater((t,s)=>Object.assign(Object.assign({},t),{email:s})),this.updateFullName=this.updater((t,s)=>Object.assign(Object.assign({},t),{fullName:s})),this.updateUserName=this.effect(t=>t.pipe((0,S.w)(s=>this.profileService.updateName(s).pipe((0,y.b)({next:()=>this.updateFullName(s),error:r=>console.log(r)}),(0,x.K)(()=>P.E))))),this.updateUserEmail=this.effect(t=>t.pipe((0,S.w)(({email:s,password:r})=>this.profileService.updateEmail(s,r).pipe((0,y.b)({next:()=>this.updateEmail(s),error:l=>console.log(l)}),(0,x.K)(()=>P.E))))),this.updateUserPassword=this.effect(t=>t.pipe((0,S.w)(({newPassword:s,oldPassword:r})=>this.profileService.updatePassword(s,r).pipe((0,y.b)({next:()=>console.log("Updated Password"),error:l=>console.log(l)}),(0,x.K)(()=>P.E)))))}}return o.\u0275fac=function(e){return new(e||o)(i.LFG(U.H))},o.\u0275prov=i.Yz7({token:o,factory:o.\u0275fac}),o})();var re=a(7556);function le(o,n){if(1&o&&(i.TgZ(0,"ion-col",9),i._uU(1),i.ALo(2,"async"),i.qZA()),2&o){const e=i.oxw();let t;i.xp6(1),i.hij(" ",null==(t=i.lcZ(2,1,e.userProfile$))?null:t.fullName," ")}}function ae(o,n){1&o&&(i.TgZ(0,"ion-col",10)(1,"span"),i._uU(2,"Tap here to edit..."),i.qZA()())}function ce(o,n){if(1&o&&(i.TgZ(0,"ion-col",9),i._uU(1),i.ALo(2,"async"),i.qZA()),2&o){const e=i.oxw();let t;i.xp6(1),i.hij(" ",null==(t=i.lcZ(2,1,e.userProfile$))?null:t.email," ")}}function ue(o,n){1&o&&(i.TgZ(0,"ion-col",10)(1,"span"),i._uU(2,"Tap here to edit..."),i.qZA()())}const fe=[{path:"",component:(()=>{class o{constructor(e,t,s,r,l){this.authService=e,this.router=t,this.profileService=s,this.alertCtrl=r,this.profileStore=l,this.userProfile$=this.profileStore.userProfile$}ngOnInit(){this.userProfileSubscription=this.profileService.getUserProfile().subscribe(e=>this.profileStore.setState(e))}ngOnDestroy(){var e;null===(e=this.userProfileSubscription)||void 0===e||e.unsubscribe()}logOut(){return(0,h.mG)(this,void 0,void 0,function*(){yield this.authService.logout(),this.router.navigateByUrl("login")})}updateName(){this.userProfileSubscription=this.userProfile$.pipe((0,M.P)()).subscribe(e=>(0,h.mG)(this,void 0,void 0,function*(){return yield(yield this.alertCtrl.create({subHeader:"Change your name",inputs:[{type:"text",name:"fullName",placeholder:"Your full name",value:e.fullName}],buttons:[{text:"Cancel"},{text:"Save",handler:s=>{this.profileStore.updateUserName(s.fullName)}}]})).present()}))}updateEmail(){return(0,h.mG)(this,void 0,void 0,function*(){return yield(yield this.alertCtrl.create({subHeader:"Change your email",inputs:[{type:"text",name:"newEmail",placeholder:"Your new email"},{name:"password",placeholder:"Your password",type:"password"}],buttons:[{text:"Cancel"},{text:"Save",handler:t=>{this.profileStore.updateUserEmail({email:t.newEmail,password:t.password})}}]})).present()})}updatePassword(){return(0,h.mG)(this,void 0,void 0,function*(){return yield(yield this.alertCtrl.create({subHeader:"Change your password",inputs:[{name:"newPassword",placeholder:"New password",type:"password"},{name:"oldPassword",placeholder:"Old password",type:"password"}],buttons:[{text:"Cancel"},{text:"Save",handler:t=>{this.profileStore.updateUserPassword({newPassword:t.newPassword,oldPassword:t.oldPassword})}}]})).present()})}}return o.\u0275fac=function(e){return new(e||o)(i.Y36(re.e),i.Y36(N.F0),i.Y36(U.H),i.Y36(u.Br),i.Y36(Y))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-profile"]],features:[i._Bn([Y])],decls:42,vars:12,consts:[["slot","end"],[3,"click"],["color","danger","slot","icon-only","name","log-out-outline"],[1,"favorite-header"],[1,"favorite-header-title"],["size","5",1,"text-left"],["class","text-center","size","7",4,"ngIf"],["size","7","class","placeholder-profile text-center",4,"ngIf"],["size","7",1,"placeholder-profile"],["size","7",1,"text-center"],["size","7",1,"placeholder-profile","text-center"]],template:function(e,t){if(1&e&&(i.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),i._uU(3,"SmartCook | Profile"),i.qZA(),i.TgZ(4,"ion-buttons",0)(5,"ion-button",1),i.NdJ("click",function(){return t.logOut()}),i._UZ(6,"ion-icon",2),i.qZA()()()(),i.TgZ(7,"ion-content")(8,"ion-list")(9,"div",3)(10,"ion-list")(11,"ion-list-header",4),i._uU(12,"Personnal infomations"),i.qZA()()()(),i.TgZ(13,"ion-item",1),i.NdJ("click",function(){return t.updateName()}),i.TgZ(14,"ion-label")(15,"ion-grid")(16,"ion-row")(17,"ion-col",5),i._uU(18," Name "),i.qZA(),i.YNc(19,le,3,3,"ion-col",6),i.ALo(20,"async"),i.YNc(21,ae,3,0,"ion-col",7),i.ALo(22,"async"),i.qZA()()()(),i.TgZ(23,"ion-item",1),i.NdJ("click",function(){return t.updateEmail()}),i.TgZ(24,"ion-label")(25,"ion-grid")(26,"ion-row")(27,"ion-col",5),i._uU(28," Email "),i.qZA(),i.YNc(29,ce,3,3,"ion-col",6),i.ALo(30,"async"),i.YNc(31,ue,3,0,"ion-col",7),i.ALo(32,"async"),i.qZA()()()(),i.TgZ(33,"ion-item",1),i.NdJ("click",function(){return t.updatePassword()}),i.TgZ(34,"ion-label")(35,"ion-grid")(36,"ion-row")(37,"ion-col",5),i._uU(38," Password "),i.qZA(),i.TgZ(39,"ion-col",8)(40,"span"),i._uU(41,"Tap here to edit..."),i.qZA()()()()()()()),2&e){let s,r,l,c;i.xp6(19),i.Q6J("ngIf",null==(s=i.lcZ(20,4,t.userProfile$))?null:s.fullName),i.xp6(2),i.Q6J("ngIf",!(null!=(r=i.lcZ(22,6,t.userProfile$))&&r.fullName)),i.xp6(8),i.Q6J("ngIf",null==(l=i.lcZ(30,8,t.userProfile$))?null:l.email),i.xp6(2),i.Q6J("ngIf",!(null!=(c=i.lcZ(32,10,t.userProfile$))&&c.email))}},directives:[u.Gu,u.sr,u.wd,u.Sm,u.YG,u.gu,u.W2,u.q_,u.yh,u.Ie,u.Q$,u.jY,u.Nd,u.wI,m.O5],pipes:[m.Ov],styles:[".text-center[_ngcontent-%COMP%]{text-align:center}.text-left[_ngcontent-%COMP%]{text-align:left}.placeholder-profile[_ngcontent-%COMP%]{color:#ccc}"]}),o})()}];let he=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[[m.ez,z.u5,u.Pc,N.Bz.forChild(fe)]]}),o})()}}]);